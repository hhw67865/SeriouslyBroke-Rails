<%# Expense Categories Chart %>
<div class="bg-white rounded shadow-sm p-6">
  <div class="flex items-center justify-between mb-6">
    <h3 class="font-semibold text-gray-900">Expense Categories</h3>
  </div>

  <div class="h-[250px]">
    <%
      # Get expense breakdown by category for current month
      category_data = current_user.entries
        .joins(item: :category)
        .where(categories: { category_type: :expense })
        .where(date: Date.current.beginning_of_month..Date.current.end_of_month)
        .group("categories.name")
        .sum(:amount)
    %>
    <% if category_data.any? %>
      <%= pie_chart category_data,
          donut: true,
          prefix: "$",
          thousands: ",",
          height: "250px",
          legend: "bottom" %>
    <% else %>
      <div class="h-full flex items-center justify-center text-gray-500 text-sm">
        No expense data for this month
      </div>
    <% end %>
  </div>
</div> 